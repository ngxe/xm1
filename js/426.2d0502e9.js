"use strict";(self["webpackChunkvue_shopping"]=self["webpackChunkvue_shopping"]||[]).push([[426],{1426:function(e,s,t){t.r(s),t.d(s,{default:function(){return h}});var a=function(){var e=this,s=e._self._c;return s("div",[s("van-nav-bar",{attrs:{fixed:"",title:e.$route.query.mode||"新增收货地址","left-arrow":""},on:{"click-left":function(s){return e.$router.go(-1)}}}),s("div",{staticClass:"content"},[s("br"),s("van-address-edit",{attrs:{"show-detail":!1,"show-set-default":e.isShowDefaultss,"area-columns-placeholder":["请选择","请选择","请选择"],addressInfo:e.addressInfo,"show-delete":e.isDeleted,"show-area":!1},on:{save:e.onSave,delete:e.onDelete},model:{value:e.addressInfo,callback:function(s){e.addressInfo=s},expression:"addressInfo"}},[[s("van-field",{attrs:{required:"","is-link":"",readonly:"",label:"地区",placeholder:"请选择所在地区"},on:{click:function(s){e.show=!0}},model:{value:e.fieldValue,callback:function(s){e.fieldValue=s},expression:"fieldValue"}}),s("van-popup",{attrs:{round:"",position:"bottom"},model:{value:e.show,callback:function(s){e.show=s},expression:"show"}},[s("van-cascader",{attrs:{title:"请选择所在地区",options:e.areasList},on:{close:function(s){e.show=!1},finish:e.onFinish},model:{value:e.cascaderValue,callback:function(s){e.cascaderValue=s},expression:"cascaderValue"}})],1),s("van-cell-group",[s("van-field",{attrs:{label:"详细地址",placeholder:"街道门牌、楼层房间等信息"},model:{value:e.value,callback:function(s){e.value=s},expression:"value"}})],1)]],2)],1)],1)},n=[],i=(t(6743),t(8848)),r=(t(7658),t(7247)),d=t(170),o={name:"newAddress",data(){return{isDeleted:!!this.$route.query.id,isShowDefaultss:!0,value:"",areasList:(0,r.JL)()||[],show:!1,fieldValue:"",cascaderValue:"",region:[],addressInfo:{name:"",tel:"",province:"",city:"",county:"",isDefault:!1}}},computed:{name:{get(){return this.addressInfo.name},set(e){this.addressInfo.name=e}},phone:{get(){return this.addressInfo.tel},set(e){this.addressInfo.tel=e}},detail:{get(){return this.value},set(e){this.value=e}}},created(){i.Z.loading({message:"加载中...",forbidClick:!0,loadingType:"spinner",duration:100}),this.getRegionFn(),this.getAddressDetail()},methods:{onFinish({selectedOptions:e}){this.show=!1,this.fieldValue=e.map((e=>e.text)).join("/"),this.region=e.map((e=>({value:e.value,label:e.text})))},async getRegionFn(){if(this.areasList.length>0)return;const e=await(0,d.GI)(),{data:{list:s}}=e;(0,r.Hd)(this.transformData(s)),this.areasList=(0,r.JL)()},async onSave(e){this.name=e.name,this.phone=e.tel,this.isDefault=e.isDefault,this.$route.query.id?(i.Z.success("修改成功"),this.editAddressFn()):(i.Z.success("新增成功"),this.newAddressFn()),await this.$sleep(1e3),this.$router.replace("/myAddress")},async onDelete(){i.Z.success("删除成功"),this.delAddressFn(),await this.$sleep(1e3),this.$router.replace("/myAddress")},async newAddressFn(){await(0,d.EY)(this.name,this.phone,this.region,this.detail)},async getAddressDetail(){if(!this.$route.query.id)return void(this.isShowDefaultss=!1);const{data:{defaultId:e}}=await(0,d.ID)(),{data:{detail:s}}=await(0,d.bM)(this.$route.query.id);s.address_id===e&&(this.isShowDefaultss=!1),this.name=s.name,this.phone=s.phone,this.value=s.detail,this.fieldValue=Object.values(s.region).map((e=>e)).join("/")},async editAddressFn(){!1!==this.isDefault&&(await(0,d.NW)(this.$route.query.id),await(0,d.gh)(this.$route.query.id,this.name,this.phone,this.region,this.detail))},async delAddressFn(){await(0,d.n5)(this.$route.query.id)},transformData(e){const s=[];for(const t in e){const a=e[t],n={text:e[t].name,value:e[t].id,children:[]};for(const e in a.city){const s=a.city[e],t={text:a.city[e].name,value:a.city[e].id,children:[]};for(const e in s.region){const a={text:s.region[e].name,value:s.region[e].id};t.children.push(a)}n.children.push(t)}s.push(n)}return s}}},l=o,u=t(1001),c=(0,u.Z)(l,a,n,!1,null,"50286548",null),h=c.exports},170:function(e,s,t){t.d(s,{EY:function(){return r},GI:function(){return l},ID:function(){return c},NW:function(){return u},bM:function(){return i},gh:function(){return d},n5:function(){return o},zM:function(){return n}});var a=t(4471);const n=()=>a.Z.get("/address/list"),i=e=>a.Z.get("/address/detail",{params:{addressId:e}}),r=(e,s,t,n)=>a.Z.post("/address/add",{form:{name:e,phone:s,region:t,detail:n}}),d=(e,s,t,n,i)=>a.Z.post("/address/edit",{addressId:e,form:{name:s,phone:t,region:n,detail:i}}),o=e=>a.Z.post("/address/remove",{addressId:e}),l=()=>a.Z.get("/region/tree"),u=e=>a.Z.post("/address/setDefault",{addressId:e}),c=()=>a.Z.get("/address/defaultId")}}]);
//# sourceMappingURL=426.2d0502e9.js.map